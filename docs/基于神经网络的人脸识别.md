# 基于神经网络的人脸识别


## 问题描述

## 总体框架

训练：
输入训练图像，将图像中的人脸抽取出来，格式化为一定格式的图像
将图像编码为数据，在数据后面加上训练标签
开始训练，epoch=30，mini_batch=10，dropout

网络结构：
输入层 - 卷积池化层 - 卷积池化层 - 全连接层 - 输出层

测试：
输入测试图像和测试标签
开始测试
估计准确率

性能评估：
准确率，时间

改变结构对网络性能的影响：
卷积核的数量
全连接层的神经元数量

### 输入编码
将图像中的人脸提取出来，转化成64\*64格式的灰度图像
将灰度值映射为[0, 1]之间的数值
输入数据：(图像编码, 标签)
其中，图像编码是一个64\*64的元组
标签是图像的真实分类，如果有5个分类结果，那么标签是一个五维向量，向量中只有一个的值为1，为真实分类结果，其余值均为0

需要学习：numpy操作矩阵


### 神经网络

需要学习：神经网络中的各种层，CNN梯度下降和反向传播算法和实现，

### 总体框架
人脸检测及特征点检测 人脸对齐 人脸识别

### 人脸检测
人脸检测的方法有很多，比如opencv自带的Haar Cascade Classfier，dlib人脸检测方法等
对于opencv的检测方法简单，快速，存在的问题是人脸检测效果不好。正面/垂直/光线较好的人脸可以检测出来，而侧面/歪斜/光线不好的人脸无法检测。因此，该方法不适合现场应用。对于dlib人脸检测方法 ，效果好于opencv的方法，但是检测力度也难以达到现场应用标准。

mtcnn人脸检测方法对自然环境中光线，角度和人脸表情变化更具有鲁棒性，人脸检测效果更好；同时，内存消耗不大，可以实现实时人脸检测。


卷积神经网络用于人脸识别是一种基于特征的方法，区别于传统的人工特征提取和针对特征的高性能分类器设计，它的优点是通过逐层卷积降维进行特征提取，然后经过多层非线性映射，使网络可以从未经特殊处理的训练样本中，自动学习形成适应该识别任务的特征提取器和分类器，该方法降低了对训练样本的要求，而且网络的层数越多，学习到的特征更具有全局性。

卷积层和池化层用于特征提取

全连接层 - 增强网络的非线性能力
LeNet-5是LeCun提出的一个具有高识别率的用于手写数字的卷积神经网络


网络性能评估：
改变两层卷积核的数量
改变全连接层神经元的数量
改变
测试单次识别所需时间（或者是100次识别所需时间/100）

为什么网络训练需要负例
CNN 网络对旋转和平移是鲁棒的，也就是说，旋转和平移并不能提升CNN的效果 - 可以通过不变的特征来确定，也就是不变的卷积核


第一个卷积层识别图像中最基本的特征，比如：眼睛，鼻子等等；第二个卷积层识别
Now suppose that there is a face at one of the corners of the image (represented by two red and a magenta point). The two eyes are detected by the first filter, and therefore will represent two activations at the first slice of the green volume. The same happens for the nose, except that it is detected for the second filter and it appears at the second slice. Next, the face filter will find that there are two eyes and a nose next to each other, and it generates an activation at the yellow volume (within the same region of the face at the input image). Finally, the fully-connected layer detects that there is a face (and maybe a leg and an arm detected by other filters) and it outputs that it has detected an human body.
